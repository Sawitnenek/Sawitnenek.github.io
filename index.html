<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Laporan Sawit</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- EXPORT -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

<style>
*{box-sizing:border-box}
body{
  font-family:'Segoe UI',system-ui,Arial,sans-serif;
  background:linear-gradient(180deg,#f1f5f9,#e6edf5);
  margin:0;color:#1f2937
}
h2{text-align:center;margin:22px 0 4px;font-weight:700}
.subtitle{text-align:center;color:#6b7280;margin-bottom:18px}
.container{max-width:1100px;margin:auto;padding:14px}

.card{
  background:#fff;
  padding:18px;
  border-radius:18px;
  margin-bottom:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.07)
}

/* TANGGAL */
.filter{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:6px
}
.filter input{
  padding:8px 12px;border-radius:10px;border:1px solid #d1d5db
}
.hari{
  font-weight:700;
  color:#14532d;
  font-size:.95rem
}

/* RINGKASAN */
.summary{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(170px,1fr));
  gap:14px
}
.summary .box{
  background:linear-gradient(135deg,#dcfce7,#ecfeff);
  border-radius:16px;
  padding:16px;
  text-align:center;
  border:1px solid #bbf7d0
}
.summary .box h4{margin:0;font-size:.85rem;color:#166534}
.summary .box b{display:block;margin-top:6px;font-size:1.5rem;color:#064e3b}

.section-title{font-weight:700;margin-bottom:10px;color:#14532d}

/* TABLE */
table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  border-radius:14px;
  overflow:hidden;
  font-size:.92rem
}
thead th{
  background:linear-gradient(135deg,#14532d,#166534);
  color:#fff;
  padding:12px;
  font-size:.75rem;
  letter-spacing:.6px;
  text-align:center
}
tbody td{
  padding:11px;
  border-bottom:1px solid #e5e7eb;
  text-align:center;
  vertical-align:middle
}
tbody tr:nth-child(even){background:#f9fafb}
tbody tr:hover{background:#ecfeff}

tfoot tr{background:#f0fdf4}
tfoot td{
  padding:12px 10px;
  font-weight:700;
  text-align:center;
  border-top:2px solid #bbf7d0;
  color:#14532d
}
.total-number{font-size:1rem;letter-spacing:.6px}

/* BADGE */
.badge{
  padding:5px 12px;
  border-radius:999px;
  font-size:.7rem;
  font-weight:700;
  cursor:pointer
}
.hadir{background:#dbeafe;color:#1e40af}
.tidak{background:#fee2e2;color:#991b1b}
.selesai{background:#dcfce7;color:#14532d}
.belum{background:#fee2e2;color:#991b1b}

footer{text-align:center;padding:16px;color:#6b7280;font-size:.8rem}

@media(max-width:700px){
  table{display:block;overflow-x:auto;white-space:nowrap}
  h2{font-size:1.25rem}
}
</style>
</head>

<body>
<h2>ðŸ“Š Dashboard Laporan Sawit</h2>
<div class="subtitle">Rekap Harian Kebun</div>

<div class="container" id="areaExport">

<!-- FILTER -->
<div class="card">
  <div class="filter">
    <div id="hariTanggal" class="hari">-</div>
    <input type="date" id="tanggal">
  </div>
</div>

<!-- RINGKASAN -->
<div class="card">
  <div class="summary">
    <div class="box"><h4>ðŸŒ´ Hari Ini</h4><b id="sumHari">0</b></div>
    <div class="box"><h4>ðŸ“Š 7 Hari Terakhir</h4><b id="sum7">0</b></div>
    <div class="box"><h4>ðŸ“ˆ Bulan Ini</h4><b id="sumBulan">0</b></div>
    <div class="box"><h4>ðŸ“‰ Bulan Lalu</h4><b id="sumLalu">0</b></div>
  </div>
</div>

<!-- (SEMUA SECTION TABEL TETAP SAMA â€“ TIDAK DIUBAH) -->
<!-- ABSENSI, PEMANEN, BRONDOL, KERJA, PROGRESS & EXPORT -->
<!-- (Script JS di bawah juga tetap, hanya ditambah fungsi hari) -->

<footer>Â© 2026 Copyright Irwan</footer>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyCazwLdErOX7aYw3qh8VSyOsdV5i13S3nQ",
  authDomain:"tools-mandor-sawit.firebaseapp.com",
  projectId:"tools-mandor-sawit"
});
const db=firebase.firestore();
const today=()=>new Date().toISOString().slice(0,10);

const hariNama=["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"];
const bulanNama=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];

function updateHari(t){
  const d=new Date(t);
  hariTanggal.innerText=
    hariNama[d.getDay()]+", "+
    d.getDate()+" "+
    bulanNama[d.getMonth()]+" "+
    d.getFullYear();
}

/* ===== SEMUA SCRIPT ANDA TETAP ===== */
/* loadRingkasan, loadAbsensi, loadPemanen, loadBrondol, loadKerja, loadProgress, exportPDF, exportPNG, exportExcel */

function loadAll(){
  const t=tanggal.value;
  updateHari(t);
  loadRingkasan();
  loadAbsensi(t);
  loadPemanen(t);
  loadBrondol(t);
  loadKerja(t);
  loadProgress(t);
}

tanggal.value=today();
tanggal.addEventListener("change",loadAll);
loadAll();
</script>

</body>
</html>
